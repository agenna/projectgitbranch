this is from testforconflict branch